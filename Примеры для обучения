Для предобучения:

<text>
Машинное обучение — это раздел искусственного интеллекта, который изучает алгоритмы, способные обучаться на данных и делать предсказания. Основные типы задач: классификация, регрессия, кластеризация.
</text>

<book>
Глава 1: Введение в Python
Python является интерпретируемым, высокоуровневым языком программирования общего назначения. Создан Гвидо ван Россумом и выпущен в 1991 году.

Глава 2: Основные конструкции
Переменные в Python не требуют явного объявления типа. Динамическая типизация позволяет присваивать переменным значения разных типов.
</book>

<code>
def calculate_average(numbers):
    """Вычисляет среднее значение списка чисел."""
    if not numbers:
        return 0
    return sum(numbers) / len(numbers)

class Rectangle:
    def __init__(self, width, height):
        self.width = width
        self.height = height
    
    def area(self):
        return self.width * self.height
</code>

<text>
Трансформеры революционизировали обработку естественного языка. Архитектура, представленная в статье "Attention Is All You Need", использует механизм внимания вместо рекуррентных сетей.
</text>

<code>
import numpy as np

def sigmoid(x):
    """Сигмоидная функция активации."""
    return 1 / (1 + np.exp(-x))

def relu(x):
    """Функция активации ReLU."""
    return np.maximum(0, x)
</code>

<text>
Градиентный спуск — это итеративный метод оптимизации, используемый для минимизации функции потерь. Основные варианты: стохастический, мини-батч и полный батч градиентный спуск.
</text>

<book>
Глава 3: Функции и модули
Функции в Python определяются с помощью ключевого слова def. Они могут принимать аргументы и возвращать значения с помощью return.

Модули позволяют организовывать код в отдельные файлы. Для импорта используется ключевое слово import.
</book>

<code>
# Пример обработки исключений
try:
    file = open("data.txt", "r")
    content = file.read()
    print(content)
except FileNotFoundError:
    print("Файл не найден!")
finally:
    file.close()

# Генератор списка
squares = [x**2 for x in range(10) if x % 2 == 0]
</code>

<text>
Регуляризация помогает бороться с переобучением в машинном обучении. Популярные методы: L1 (лассо), L2 (ридж) и dropout.
</text>

Для дообучения:

<p>
<user> Как написать функцию факториала на Python?
<bot> <start> Вот реализация функции факториала:
def factorial(n):
    if n == 0 or n == 1:
        return 1
    else:
        return n * factorial(n - 1)
<end>
</p>

<p>
<user> Объясни, что такое декоратор в Python
<bot> <start> Декоратор — это функция, которая принимает другую функцию и расширяет её поведение без изменения кода исходной функции. Пример:
def my_decorator(func):
    def wrapper():
        print("Перед вызовом функции")
        func()
        print("После вызова функции")
    return wrapper

@my_decorator
def say_hello():
    print("Привет!")
<end>
</p>

<p>
<user> Напиши код для чтения файла JSON
<bot> <start> Для чтения JSON файла в Python используйте модуль json:
import json

def read_json_file(filename):
    with open(filename, 'r', encoding='utf-8') as file:
        data = json.load(file)
    return data

# Пример использования
data = read_json_file('config.json')
print(data)
<end>
</p>

<p>
<user> Как отсортировать словарь по значениям?
<bot> <start> Вот несколько способов сортировки словаря по значениям:
# Способ 1: Использование sorted()
my_dict = {'a': 3, 'b': 1, 'c': 2}
sorted_dict = dict(sorted(my_dict.items(), key=lambda item: item[1]))

# Способ 2: С использованием collections.OrderedDict
from collections import OrderedDict
ordered_dict = OrderedDict(sorted(my_dict.items(), key=lambda x: x[1]))
<end>
</p>

<p>
<user> Что делает функция map() в Python?
<bot> <start> Функция map() применяет указанную функцию к каждому элементу итерируемого объекта:
# Пример: умножение всех элементов списка на 2
numbers = [1, 2, 3, 4, 5]
doubled = list(map(lambda x: x * 2, numbers))
print(doubled)  # [2, 4, 6, 8, 10]

# Пример с именованной функцией
def square(x):
    return x ** 2

squares = list(map(square, numbers))
print(squares)  # [1, 4, 9, 16, 25]
<end>
</p>

<p>
<user> Как обработать исключение при делении на ноль?
<bot> <start> Используйте блок try-except для обработки исключений:
def safe_divide(a, b):
    try:
        result = a / b
        return result
    except ZeroDivisionError:
        print("Ошибка: деление на ноль!")
        return None
    except TypeError:
        print("Ошибка: неверный тип данных!")
        return None

# Примеры использования
print(safe_divide(10, 2))   # 5.0
print(safe_divide(10, 0))   # Ошибка: деление на ноль!
<end>
</p>

<p>
<user> Напиши функцию для проверки простого числа
<bot> <start> Вот функция для проверки, является ли число простым:
def is_prime(n):
    if n <= 1:
        return False
    if n <= 3:
        return True
    if n % 2 == 0 or n % 3 == 0:
        return False
    
    i = 5
    while i * i <= n:
        if n % i == 0 or n % (i + 2) == 0:
            return False
        i += 6
    return True

# Пример использования
print(is_prime(7))   # True
print(is_prime(10))  # False
<end>
</p>

<p>
<user> Как объединить два словаря?
<bot> <start> Есть несколько способов объединить словари:
# Способ 1: Использование ** (Python 3.5+)
dict1 = {'a': 1, 'b': 2}
dict2 = {'c': 3, 'd': 4}
merged = {**dict1, **dict2}

# Способ 2: Метод update()
dict1 = {'a': 1, 'b': 2}
dict2 = {'b': 3, 'c': 4}
dict1.update(dict2)  # dict1 теперь {'a': 1, 'b': 3, 'c': 4}

# Способ 3: collections.ChainMap
from collections import ChainMap
chain = ChainMap(dict1, dict2)
<end>
</p>

<p>
<user> Что такое lambda-функция?
<bot> <start> Lambda-функция — это анонимная функция, определяемая в одной строке:
# Пример lambda-функции
add = lambda x, y: x + y
print(add(5, 3))  # 8

# Использование в сортировке
students = [{'name': 'Alice', 'grade': 85},
            {'name': 'Bob', 'grade': 92},
            {'name': 'Charlie', 'grade': 78}]

# Сортировка по оценке
sorted_students = sorted(students, key=lambda x: x['grade'])
<end>
</p>

<p>
<user> Как работать с датами в Python?
<bot> <start> Используйте модуль datetime:
from datetime import datetime, date, timedelta

# Текущая дата и время
now = datetime.now()
print(f"Сейчас: {now}")

# Создание конкретной даты
birthday = date(1990, 5, 15)
print(f"День рождения: {birthday}")

# Работа с интервалами
today = date.today()
yesterday = today - timedelta(days=1)
tomorrow = today + timedelta(days=1)

# Форматирование даты
formatted = now.strftime("%d.%m.%Y %H:%M:%S")
print(formatted)  # 01.06.2026 15:30:45
<end>
</p>
